var be=Object.defineProperty,ve=Object.defineProperties;var $e=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var le=(n,e,r)=>e in n?be(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r,J=(n,e)=>{for(var r in e||(e={}))we.call(e,r)&&le(n,r,e[r]);if(re)for(var r of re(e))ye.call(e,r)&&le(n,r,e[r]);return n},L=(n,e)=>ve(n,$e(e));import{S as G,i as U,s as A,I as M,K as ke,e as v,w as x,k as O,c as $,a as k,x as I,d as p,m as T,b as m,g as C,F as b,y as N,H as D,W as ne,L as Ee,M as Ce,N as xe,q as w,o as y,B as P,U as ae,Q as se,D as z,X as Ie,l as S,P as Ne,Y as Pe,Z as De,G as F,_ as Oe,$ as Te,a0 as Ge,a1 as V,n as W,p as X,t as j,h as q,V as Ue,j as oe,R as K,J as ie}from"./vendor-0536b2c5.js";import{u as Ae,b as Q}from"./auth-ace2d5de.js";function Se(n){let e,r,t,l,s,a,o,i,h;l=new M({props:{icon:"vaadin:close"}});const g=n[3].default,u=ke(g,n,n[2],null);return{c(){e=v("div"),r=v("div"),t=v("button"),x(l.$$.fragment),s=O(),u&&u.c(),this.h()},l(f){e=$(f,"DIV",{class:!0});var c=k(e);r=$(c,"DIV",{class:!0});var d=k(r);t=$(d,"BUTTON",{class:!0});var _=k(t);I(l.$$.fragment,_),_.forEach(p),s=T(d),u&&u.l(d),d.forEach(p),c.forEach(p),this.h()},h(){m(t,"class","absolute top-0 left-0 m-4 text-gray-500 hover:text-gray-600 focus:text-gray-600"),m(r,"class",a="relative h-full max-h-96 w-full max-w-md rounded-md bg-white "+n[0]),m(e,"class","absolute inset-0 z-10 grid place-items-center bg-black/40 backdrop-blur-[2px]")},m(f,c){C(f,e,c),b(e,r),b(r,t),N(l,t,null),b(r,s),u&&u.m(r,null),o=!0,i||(h=[D(t,"click",n[1]),D(r,"click",ne(Ve)),D(e,"click",n[1])],i=!0)},p(f,[c]){u&&u.p&&(!o||c&4)&&Ee(u,g,f,f[2],o?xe(g,f[2],c,null):Ce(f[2]),null),(!o||c&1&&a!==(a="relative h-full max-h-96 w-full max-w-md rounded-md bg-white "+f[0]))&&m(r,"class",a)},i(f){o||(w(l.$$.fragment,f),w(u,f),o=!0)},o(f){y(l.$$.fragment,f),y(u,f),o=!1},d(f){f&&p(e),P(l),u&&u.d(f),i=!1,ae(h)}}}const Ve=()=>{};function Be(n,e,r){let{$$slots:t={},$$scope:l}=e,{classes:s=""}=e;const a=se();function o(){a("close")}return n.$$set=i=>{"classes"in i&&r(0,s=i.classes),"$$scope"in i&&r(2,l=i.$$scope)},[s,o,l,t]}class ce extends G{constructor(e){super();U(this,e,Be,Se,A,{classes:0})}}const B=z(null);function Y(n,e){const r=e.map(t=>t.reduce((l,s)=>l+(s?"1":"0"),"	B")).join(`,
`);return`byte ${n}[] = {
${r}
};
`}const{document:Z}=Oe;function Me(n){let e,r,t;return e=new M({props:{icon:"mdi:content-copy"}}),{c(){x(e.$$.fragment),r=j(`
				copy`)},l(l){I(e.$$.fragment,l),r=q(l,`
				copy`)},m(l,s){N(e,l,s),C(l,r,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){P(e,l),l&&p(r)}}}function je(n){let e,r,t;return e=new M({props:{icon:"mdi:check"}}),{c(){x(e.$$.fragment),r=j(`
				Copied!`)},l(l){I(e.$$.fragment,l),r=q(l,`
				Copied!`)},m(l,s){N(e,l,s),C(l,r,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){P(e,l),l&&p(r)}}}function qe(n){let e,r,t,l,s,a,o,i,h;r=new Te({props:{language:Ge,code:Y("name",n[1].character.grid)}});const g=[je,Me],u=[];function f(c,d){return c[0]?0:1}return s=f(n),a=u[s]=g[s](n),{c(){e=v("div"),x(r.$$.fragment),t=O(),l=v("button"),a.c(),this.h()},l(c){e=$(c,"DIV",{class:!0});var d=k(e);I(r.$$.fragment,d),t=T(d),l=$(d,"BUTTON",{class:!0});var _=k(l);a.l(_),_.forEach(p),d.forEach(p),this.h()},h(){m(l,"class","flex w-full items-center justify-center gap-2 rounded bg-indigo-500 py-2 font-bold text-white  svelte-1y410tu"),V(l,"copied",n[0]),m(e,"class","flex h-full flex-col p-4")},m(c,d){C(c,e,d),N(r,e,null),b(e,t),b(e,l),u[s].m(l,null),o=!0,i||(h=D(l,"click",n[2]),i=!0)},p(c,d){const _={};d&2&&(_.code=Y("name",c[1].character.grid)),r.$set(_);let E=s;s=f(c),s!==E&&(W(),y(u[E],1,1,()=>{u[E]=null}),X(),a=u[s],a||(a=u[s]=g[s](c),a.c()),w(a,1),a.m(l,null)),d&1&&V(l,"copied",c[0])},i(c){o||(w(r.$$.fragment,c),w(a),o=!0)},o(c){y(r.$$.fragment,c),y(a),o=!1},d(c){c&&p(e),P(r),u[s].d(),i=!1,h()}}}function Re(n){let e,r,t,l,s;return l=new ce({props:{$$slots:{default:[qe]},$$scope:{ctx:n}}}),l.$on("close",n[3]),{c(){e=new Ie,r=S(),t=O(),x(l.$$.fragment),this.h()},l(a){const o=Ne('[data-svelte="svelte-b3mtpz"]',Z.head);e=Pe(o),r=S(),o.forEach(p),t=T(a),I(l.$$.fragment,a),this.h()},h(){e.a=r},m(a,o){e.m(De,Z.head),b(Z.head,r),C(a,t,o),N(l,a,o),s=!0},p(a,[o]){const i={};o&19&&(i.$$scope={dirty:o,ctx:a}),l.$set(i)},i(a){s||(w(l.$$.fragment,a),s=!0)},o(a){y(l.$$.fragment,a),s=!1},d(a){p(r),a&&e.d(),a&&p(t),P(l,a)}}}function He(n,e,r){let t;F(n,B,o=>r(1,t=o));let l=!1;function s(){const o=document.createElement("textarea");o.value=Y("name",t.character.grid),document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),r(0,l=!0),setInterval(()=>{r(0,l=!1)},1e3*2)}return[l,t,s,()=>B.set(null)]}class Je extends G{constructor(e){super();U(this,e,He,Re,A,{})}}function ue(n,e,r){const t=n.slice();return t[8]=e[r],t}function fe(n){let e,r=n[2],t=[];for(let l=0;l<r.length;l+=1)t[l]=de(ue(n,r,l));return{c(){e=v("div");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=$(l,"DIV",{class:!0});var s=k(e);for(let a=0;a<t.length;a+=1)t[a].l(s);s.forEach(p),this.h()},h(){m(e,"class","absolute flex w-full flex-col overflow-hidden rounded-b-md")},m(l,s){C(l,e,s);for(let a=0;a<t.length;a+=1)t[a].m(e,null)},p(l,s){if(s&5){r=l[2];let a;for(a=0;a<r.length;a+=1){const o=ue(l,r,a);t[a]?t[a].p(o,s):(t[a]=de(o),t[a].c(),t[a].m(e,null))}for(;a<t.length;a+=1)t[a].d(1);t.length=r.length}},d(l){l&&p(e),Ue(t,l)}}}function de(n){let e,r=n[8]+"",t,l,s,a,o;function i(){return n[6](n[8])}return{c(){e=v("button"),t=j(r),l=O(),this.h()},l(h){e=$(h,"BUTTON",{class:!0,title:!0});var g=k(e);t=q(g,r),l=T(g),g.forEach(p),this.h()},h(){m(e,"class","bg-indigo-600 py-2 px-4 text-white transition-all duration-200 hover:bg-indigo-500"),m(e,"title",s="export as "+n[8])},m(h,g){C(h,e,g),b(e,t),b(e,l),a||(o=D(e,"click",i),a=!0)},p(h,g){n=h},d(h){h&&p(e),a=!1,o()}}}function Le(n){let e,r,t,l,s,a,o,i,h,g,u,f,c;l=new M({props:{icon:"mdi:open-in-new",class:"mr-2 h-4 w-4"}}),h=new M({props:{icon:"mdi:menu-down"}});let d=n[1]&&fe(n);return{c(){e=v("div"),r=v("div"),t=v("button"),x(l.$$.fragment),s=O(),a=j(n[0]),o=O(),i=v("button"),x(h.$$.fragment),g=O(),d&&d.c(),this.h()},l(_){e=$(_,"DIV",{class:!0});var E=k(e);r=$(E,"DIV",{class:!0});var R=k(r);t=$(R,"BUTTON",{class:!0});var H=k(t);I(l.$$.fragment,H),s=T(H),a=q(H,n[0]),H.forEach(p),o=T(R),i=$(R,"BUTTON",{title:!0,class:!0});var te=k(i);I(h.$$.fragment,te),te.forEach(p),R.forEach(p),g=T(E),d&&d.l(E),E.forEach(p),this.h()},h(){m(t,"class","flex items-center py-2 px-4 text-white transition-all duration-200 hover:bg-indigo-500"),m(i,"title","export type selection"),m(i,"class","h-full px-2 text-white transition-all duration-200 hover:bg-indigo-500"),m(r,"class","relative flex h-10 w-max items-center overflow-hidden rounded-md bg-indigo-600"),V(r,"rounded-b-none",n[1]),m(e,"class","relative w-max")},m(_,E){C(_,e,E),b(e,r),b(r,t),N(l,t,null),b(t,s),b(t,a),b(r,o),b(r,i),N(h,i,null),b(e,g),d&&d.m(e,null),u=!0,f||(c=[D(t,"click",n[3]),D(i,"click",ne(n[5])),D(e,"click",n[7])],f=!0)},p(_,[E]){(!u||E&1)&&oe(a,_[0]),E&2&&V(r,"rounded-b-none",_[1]),_[1]?d?d.p(_,E):(d=fe(_),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},i(_){u||(w(l.$$.fragment,_),w(h.$$.fragment,_),u=!0)},o(_){y(l.$$.fragment,_),y(h.$$.fragment,_),u=!1},d(_){_&&p(e),P(l),P(h),d&&d.d(),f=!1,ae(c)}}}function ze(n,e,r){let t=["PNG","ARDUINO"],{character:l}=e,{current:s="ARDUINO"}=e,{selectOpen:a=!1}=e;function o(){B.set({character:l,type:s})}const i=()=>r(1,a=!a),h=u=>r(0,s=u),g=()=>r(1,a=!1);return n.$$set=u=>{"character"in u&&r(4,l=u.character),"current"in u&&r(0,s=u.current),"selectOpen"in u&&r(1,a=u.selectOpen)},[s,a,t,o,l,i,h,g]}class ut extends G{constructor(e){super();U(this,e,ze,Le,A,{character:4,current:0,selectOpen:1})}}function he(n){return n.grid.map(e=>e.toString(2).split("").slice(1).map(r=>r==="1"))}function me(n){return n.grid.map(e=>parseInt(e.reduce((r,t)=>r+(t?1:0),"1"),2))}function ee(n){const e=n[0].length,r=n.length,t=document.createElement("canvas");t.width=e,t.height=r;const l=t.getContext("2d");if(!l)return"";l.fillStyle="#000";for(let s=0;s<r;s++)for(let a=0;a<e;a++)n[s][a]&&l.fillRect(a,s,1,1);return t.toDataURL("image/png")}function Fe(){return{name:"",grid:new Array(8).fill(!1).map(n=>new Array(5).fill(!1).map(e=>!1)),width:5,height:8,saved:!1,published:!1,id:Math.floor(Math.random()*10**15)}}const pe=z([]),Ke=z(Fe());{const e=(JSON.parse(localStorage.getItem("savedCharacters"))||[]).map(r=>{const t=he(r);return L(J({},r),{saved:!0,published:!1,grid:t,width:t[0].length,height:t.length,id:Math.floor(Math.random()*10**15)})});pe.set(e),console.log("loaded savedCharacters",e)}let _e=!1;pe.subscribe(n=>{if(_e){const e=n.map(r=>({name:r.name,grid:me(r)}));localStorage.setItem("savedCharacters",JSON.stringify(e)),console.log("saved",e)}else _e=!0});function Qe(n){let e,r,t,l,s,a,o=n[0].name+"",i,h,g,u;return{c(){e=v("li"),r=v("div"),t=v("img"),s=O(),a=v("p"),i=j(o),this.h()},l(f){e=$(f,"LI",{title:!0,class:!0});var c=k(e);r=$(c,"DIV",{class:!0});var d=k(r);t=$(d,"IMG",{src:!0,alt:!0,class:!0}),d.forEach(p),s=T(c),a=$(c,"P",{class:!0});var _=k(a);i=q(_,o),_.forEach(p),c.forEach(p),this.h()},h(){K(t.src,l=ee(n[0].grid))||m(t,"src",l),m(t,"alt",""),m(t,"class","crisp aspect-auto h-1/2"),m(r,"class","grid h-16 min-w-[4rem] place-items-center bg-gray-100"),m(a,"class","max-h-[4rem] max-w-[6rem] overflow-hidden overflow-ellipsis border-b-8 border-gray-200 px-2 pb-1 text-center"),m(e,"title",h=n[0].name),m(e,"class","w-max cursor-pointer overflow-hidden rounded bg-gray-200 svelte-16n8ly6"),V(e,"active",n[1].id==n[0].id)},m(f,c){C(f,e,c),b(e,r),b(r,t),b(e,s),b(e,a),b(a,i),g||(u=D(e,"click",n[3]),g=!0)},p(f,[c]){c&1&&!K(t.src,l=ee(f[0].grid))&&m(t,"src",l),c&1&&o!==(o=f[0].name+"")&&oe(i,o),c&1&&h!==(h=f[0].name)&&m(e,"title",h),c&3&&V(e,"active",f[1].id==f[0].id)},i:ie,o:ie,d(f){f&&p(e),g=!1,u()}}}function We(n,e,r){let t;F(n,Ke,o=>r(1,t=o));let{character:l}=e;const s=se(),a=()=>s("open",l);return n.$$set=o=>{"character"in o&&r(0,l=o.character)},[l,t,s,a]}class ft extends G{constructor(e){super();U(this,e,We,Qe,A,{character:0})}}function Xe(n){let e,r,t,l;return{c(){e=v("div"),r=v("a"),t=v("img"),this.h()},l(s){e=$(s,"DIV",{class:!0});var a=k(e);r=$(a,"A",{href:!0,target:!0,class:!0});var o=k(r);t=$(o,"IMG",{src:!0,alt:!0,class:!0}),o.forEach(p),a.forEach(p),this.h()},h(){K(t.src,l=n[0])||m(t,"src",l),m(t,"alt",""),m(t,"class","crisp w-full"),m(r,"href",n[0]),m(r,"target","_blank"),m(r,"class","w-1/2"),m(e,"class","relative flex h-full items-center justify-center p-4")},m(s,a){C(s,e,a),b(e,r),b(r,t)},p(s,a){a&1&&!K(t.src,l=s[0])&&m(t,"src",l),a&1&&m(r,"href",s[0])},d(s){s&&p(e)}}}function Ye(n){let e,r;return e=new ce({props:{$$slots:{default:[Xe]},$$scope:{ctx:n}}}),e.$on("close",n[2]),{c(){x(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,l){N(e,t,l),r=!0},p(t,[l]){const s={};l&9&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function Ze(n,e,r){let t;F(n,B,a=>r(1,t=a));let l="";const s=()=>B.set(null);return n.$$.update=()=>{n.$$.dirty&2&&r(0,l=ee(t.character.grid))},[l,t,s]}class et extends G{constructor(e){super();U(this,e,Ze,Ye,A,{})}}function ge(n){let e,r,t,l;const s=[rt,tt],a=[];function o(i,h){return i[0].type==="ARDUINO"?0:i[0].type==="PNG"?1:-1}return~(e=o(n))&&(r=a[e]=s[e](n)),{c(){r&&r.c(),t=S()},l(i){r&&r.l(i),t=S()},m(i,h){~e&&a[e].m(i,h),C(i,t,h),l=!0},p(i,h){let g=e;e=o(i),e!==g&&(r&&(W(),y(a[g],1,1,()=>{a[g]=null}),X()),~e?(r=a[e],r||(r=a[e]=s[e](i),r.c()),w(r,1),r.m(t.parentNode,t)):r=null)},i(i){l||(w(r),l=!0)},o(i){y(r),l=!1},d(i){~e&&a[e].d(i),i&&p(t)}}}function tt(n){let e,r;return e=new et({}),{c(){x(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,l){N(e,t,l),r=!0},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function rt(n){let e,r;return e=new Je({}),{c(){x(e.$$.fragment)},l(t){I(e.$$.fragment,t)},m(t,l){N(e,t,l),r=!0},i(t){r||(w(e.$$.fragment,t),r=!0)},o(t){y(e.$$.fragment,t),r=!1},d(t){P(e,t)}}}function lt(n){let e,r,t=n[0]&&ge(n);return{c(){t&&t.c(),e=S()},l(l){t&&t.l(l),e=S()},m(l,s){t&&t.m(l,s),C(l,e,s),r=!0},p(l,[s]){l[0]?t?(t.p(l,s),s&1&&w(t,1)):(t=ge(l),t.c(),w(t,1),t.m(e.parentNode,e)):t&&(W(),y(t,1,1,()=>{t=null}),X())},i(l){r||(w(t),r=!0)},o(l){y(t),r=!1},d(l){t&&t.d(l),l&&p(e)}}}function nt(n,e,r){let t;return F(n,B,l=>r(0,t=l)),[t]}class dt extends G{constructor(e){super();U(this,e,nt,lt,A,{})}}const at=z([]);Ae.subscribe(async n=>{if(n){const{characters:e}=await st(n);e&&at.set(e.map(r=>{let t=he(r);return L(J({},r),{id:r.id,saved:!1,published:!0,grid:t,width:t[0].length,height:t.length})}))}});function ht(n){return L(J({},n),{saved:!1,published:!0,width:n.grid[0].length,height:n.grid.length})}async function mt(n){const{data:e,error:r}=await Q.from("characters").delete().eq("id",n.id);return console.log({deleted:e,error:r}),{deleted:e,error:r}}async function pt(n,e){let r=e.map(s=>({grid:me(s),name:s.name,id:s.id,owner_id:n.id}));const{data:t,error:l}=await Q.from("characters").upsert(r);return console.log({newCharacters:t,error:l}),{newCharacters:t,error:l}}async function st(n){const{data:e,error:r}=await Q.from("characters").select("*").eq("owner_id",n.id);return{characters:e,error:r}}async function _t(n="*"){const{data:e,error:r}=await Q.from("characters").select("grid, name").ilike("name","%"+n+"%");return{characters:e,error:r}}export{ft as C,ut as E,ce as P,dt as a,Ke as b,B as c,ht as d,pt as e,Fe as f,_t as g,he as l,at as p,mt as r,pe as s,ee as t};
